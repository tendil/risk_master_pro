from odoo import models, fields


class RiskMasterDocumentation(models.Model):
    _name = 'risk.master.documentation'
    _description = 'Документация RiskMaster Pro'

    name = fields.Char(string='Заголовок', default="Документация RiskMaster Pro")
    description = fields.Html(string='Описание', default="""
        <h2>Модуль "RiskMaster Pro" - Техническая документация</h2>

        <h3>Назначение модуля</h3>
        <p>
            Модуль <strong>"RiskMaster Pro"</strong> разработан для управления отчетами по жизненным рискам сотрудников.
            Он интегрируется с существующей бухгалтерией Odoo для автоматического извлечения данных по страховым случаям,
            связанным с медицинскими и немедицинскими рисками. Основная задача модуля — предоставление средств для управления
            этими рисками и автоматической генерации отчетов.
        </p>

        <h3>Общая структура модуля</h3>
        <ul>
            <li><strong>Модель отчета по жизненным рискам (employee.report):</strong> Хранит информацию об отчетах за определенные периоды.</li>
            <li><strong>Модель строк отчета (employee.report.line):</strong> Хранит информацию о каждом страховом случае, связанном с сотрудниками.</li>
            <li><strong>Модель поставщиков медицинского страхования (health.insurance.provider):</strong> Управляет данными о поставщиках страхования, которые связаны с отчетами.</li>
        </ul>

        <h3>Новые функции и возможности модуля</h3>
        <ul>
            <li><strong>Поддержка нескольких форматов отчетов:</strong> Теперь можно генерировать отчеты нескольких типов, таких как группировка по типам заявлений, анализ расходов, мониторинг эффективности программ и анализ затрат по месяцам.</li>
            <li><strong>Графическое представление данных:</strong> В отчете доступны диаграммы для анализа данных (круговая диаграмма по страховщикам, столбчатая диаграмма по типам заявлений и линейная диаграмма для анализа расходов по времени).</li>
            <li><strong>Экспорт отчетов:</strong> Добавлена поддержка экспорта в форматы XLSX и TXT для детального анализа.</li>
            <li><strong>Модель страховых провайдеров:</strong> Модель <em>health.insurance.provider</em> теперь управляет всеми данными о поставщиках страхования и поддерживает экспорт информации.</li>
        </ul>

        <h3>Интеграция с бухгалтерией Odoo</h3>
        <p>
            Данные для отчетов по жизненным рискам <strong>не появляются из воздуха</strong>. Модуль интегрируется с бухгалтерией Odoo и использует информацию из модуля <strong>account.move</strong> для автоматического заполнения строк отчета.
        </p>

        <h4>Процесс сбора данных:</h4>
        <ol>
            <li><strong>Фильтрация данных по датам:</strong> Когда создается новый отчет по жизненным рискам, модуль использует поля <em>date_from</em> и <em>date_to</em>, чтобы фильтровать бухгалтерские документы (<em>account.move</em>), которые относятся к страховым случаям.</li>
            <li><strong>Идентификация страховых случаев:</strong> Из отфильтрованных документов берутся данные, такие как:
                <ul>
                    <li>Дата оказания услуги (<em>invoice_date</em> в модели <em>account.move</em>).</li>
                    <li>Имя застрахованного лица (связанное с <em>partner_id</em> в <em>account.move</em>).</li>
                    <li>Сумма, заявленная по страховым случаям (общая сумма документа, включая налоги).</li>
                </ul>
            </li>
            <li><strong>Создание строк отчета:</strong> Для каждого страхового случая создается запись в модели <em>employee.report.line</em>. Эти строки содержат всю информацию о страховых требованиях, включая суммы, дату оказания услуги и связанные данные.</li>
        </ol>

        <h3>Описание моделей и полей</h3>

        <h4>Модель: Отчеты по жизненным рискам сотрудников (<em>employee.report</em>)</h4>
        <ul>
            <li><strong>Уникальный код отчета (claimant_code):</strong> Это поле автоматически генерируется при создании отчета и служит для идентификации отчета в системе.</li>
            <li><strong>Название отчета (name):</strong> Поле, которое отображает период отчета в формате "Месяц/Год". Оно генерируется автоматически на основе дат начала и окончания покрытия.</li>
            <li><strong>Страховая компания (insurer_id):</strong> Ссылка на модель <em>health.insurance.provider</em>, которая представляет страховую компанию, связанную с данным отчетом.</li>
            <li><strong>Тип страхового случая (claimant_type):</strong> Поле выбора, которое может быть либо "медицинским", либо "немедицинским".</li>
            <li><strong>Дата начала покрытия (date_from) и Дата окончания покрытия (date_to):</strong> Эти поля указывают на период страхового покрытия, за который собираются данные из бухгалтерии.</li>
            <li><strong>Строки отчета (line_ids):</strong> Список строк, связанных с отчетом. Каждая строка представляет страховой случай и содержит детализированную информацию о нем.</li>
        </ul>

        <h4>Модель: Строки отчета (<em>employee.report.line</em>)</h4>
        <ul>
            <li><strong>Код авторизации (auth_code):</strong> Поле, содержащее номер документа, сгенерированного Odoo для данного случая (например, номер счета-фактуры).</li>
            <li><strong>Дата оказания услуги (service_date_actual):</strong> Дата, когда была оказана медицинская услуга или предоставлена другая страхуемая услуга.</li>
            <li><strong>Имя филиала (affiliate_name):</strong> Название филиала, связанного с данным страховым случаем.</li>
            <li><strong>Имя застрахованного лица (insured_person_name):</strong> Имя сотрудника, для которого был зарегистрирован страховой случай.</li>
            <li><strong>Идентификационный номер (identity_number):</strong> Уникальный номер сотрудника (например, ИНН или другой идентификатор).</li>
            <li><strong>Общая заявленная сумма (total_claimed_amount):</strong> Сумма, заявленная по страховому случаю, которая может включать в себя услуги, товары и налоги.</li>
            <li><strong>Сумма за услуги (service_charge) и Сумма за товары (goods_charge):</strong> Детализация расходов по страховым случаям, разделенная на услуги и товары.</li>
            <li><strong>Общая сумма к оплате (total_payable):</strong> Итоговая сумма, подлежащая оплате, включая все налоги и сборы.</li>
        </ul>

        <h4>Модель: Поставщики медицинского страхования (<em>health.insurance.provider</em>)</h4>
        <ul>
            <li><strong>Название поставщика (name):</strong> Имя компании, предоставляющей страховые услуги.</li>
            <li><strong>Код (code):</strong> Уникальный код, присвоенный каждому поставщику.</li>
            <li><strong>Адрес (address):</strong> Физический адрес страховой компании.</li>
            <li><strong>Контактный номер (phone):</strong> Номер телефона для связи.</li>
            <li><strong>Электронная почта (email):</strong> Электронная почта поставщика.</li>
            <li><strong>Веб-сайт (website):</strong> URL сайта компании.</li>
            <li><strong>Компания Odoo (company_id):</strong> Ссылка на модель компании, для которой работает данный поставщик.</li>
            <li><strong>Валюта (currency_id):</strong> Валюта, используемая при расчетах с данным поставщиком.</li>
        </ul>

        <h3>Источники данных</h3>
        <ol>
            <li><strong>Бухгалтерские документы:</strong> Данные для отчета о жизненных рисках собираются из зарегистрированных документов в модуле <em>account.move</em>. Это могут быть счета-фактуры, кредитные или дебетовые ноты, а также другие документы, связанные с финансовыми транзакциями сотрудников.</li>
            <li><strong>Партнеры Odoo:</strong> Данные о сотрудниках (застрахованных лицах) берутся из модели <em>res.partner</em>, связанной с <em>account.move</em>. Это позволяет автоматически заполнять поля, такие как имя, идентификационный номер и контактная информация.</li>
        </ol>

        <h3>Процесс создания отчета</h3>
        <ol>
            <li>Создание нового отчета: Пользователь указывает период страхового покрытия, который интересует его для отчета (даты начала и окончания).</li>
            <li>Автоматическая генерация данных: После создания отчета система автоматически подтягивает все бухгалтерские документы за указанный период и создает строки отчета на основе этих данных.</li>
            <li>Обзор и экспорт: Пользователь может просмотреть отчет в интерфейсе Odoo и экспортировать его в форматах XLSX или TXT для дальнейшего анализа.</li>
        </ol>

        <h3>Что нужно знать пользователю перед началом работы</h3>
        <ul>
            <li><strong>Корректная настройка бухгалтерии:</strong> Чтобы модуль корректно работал, необходимо, чтобы все бухгалтерские документы, связанные с медицинскими услугами и страховыми случаями, были правильно зарегистрированы в системе.</li>
            <li><strong>Добавление поставщиков медицинских услуг:</strong> Перед созданием отчета необходимо добавить всех поставщиков медицинских страхований, с которыми работает ваша компания.</li>
            <li><strong>Регулярное обновление данных:</strong> Для того чтобы отчет содержал актуальную информацию, рекомендуется регулярно обновлять данные по страховым случаям и проверять наличие всех необходимых документов в системе.</li>
        </ul>

        <h3>Экспорт отчетов</h3>
        <p>
            Модуль поддерживает экспорт отчетов в двух форматах:
        </p>
        <ul>
            <li><strong>XLSX (Excel):</strong> Формат для более глубокого анализа данных с возможностью фильтрации и сортировки.</li>
            <li><strong>TXT:</strong> Простой текстовый формат для внутреннего использования или передачи данных в другие системы.</li>
        </ul>

        <h3>Заключение</h3>
        <p>
            Модуль <strong>"RiskMaster Pro"</strong> — это инструмент для управления жизненными рисками сотрудников с тесной интеграцией с бухгалтерией Odoo. Он предоставляет пользователю удобные средства для автоматизации сбора данных, генерации отчетов и анализа рисков.
        </p>
    """)
